{% extends 'instructors/base.html' %}
{% load static %}

{% block title %}MarAcademy - Instructor Dashboard{% endblock %}

{% block content %}
<h2>Dashboard</h2>
<div class="stats-grid">
  <div class="stat-card">
    <div class="stat-number">127</div>
    <div class="stat-label">Received</div>
  </div>
  <div class="stat-card">
    <div class="stat-number">58</div>
    <div class="stat-label">Yet to Review</div>
  </div>
  <div class="stat-card">
    <div class="stat-number">42</div>
    <div class="stat-label">Pending Review</div>
  </div>
  <div class="stat-card">
    <div class="stat-number">25</div>
    <div class="stat-label">Reviewed</div>
  </div>
  <div class="stat-card">
    <div class="stat-number">5</div>
    <div class="stat-label">Reports Generated</div>
  </div>
</div>

<div class="grid-2-1">
  <div class="card">
    <div class="card-header">
      <h3>Your Courses</h3>
      <a href="{% url 'courses:course_create' %}" class="btn">
        <i class="fas fa-plus"></i> Add New Course
      </a>
    </div>

    {% if courses %}
    <div class="course-list">
      {% for course in courses %}
      <div class="course-card">
        <h3 class="course-title">{{ course.title }}</h3>
        <p>{{ course.description|truncatewords:20 }}</p>
        <div class="course-actions">
          <a href="{% url 'courses:course_update' course.pk %}" class="btn btn-edit">
            <i class="fas fa-edit"></i> Edit
          </a>
          <form action="{% url 'courses:course_delete' course.pk %}" method="post" onsubmit="return confirm('Are you sure you want to delete this course?');">
            {% csrf_token %}
            <button type="submit" class="btn-delete">
              <i class="fas fa-trash"></i> Delete
            </button>
          </form>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
      <i class="fas fa-book-open"></i>
      <h3>No courses available</h3>
      <p>Start by adding your first course!</p>
    </div>
    {% endif %}
  </div>

  <div class="card">
    <div class="card-header">
      <h3>Students Performance</h3>
      <button>View All Students</button>
    </div>
    <div class="student-list">
      <div class="student-row">
        <div class="student-avatar">OJ</div>
        <div class="student-info">
          <div>Oliver James</div>
          <div class="text-secondary">G1 / Class A</div>
        </div>
        <div class="circular-progress" data-progress="97">
          <svg width="60" height="60">
            <circle class="progress-bg" cx="30" cy="30" r="25"></circle>
            <circle class="progress-fill" cx="30" cy="30" r="25"></circle>
          </svg>
          <span class="progress-text">7%</span>
        </div>
      </div>
      <div class="student-row">
        <div class="student-avatar">DP</div>
        <div class="student-info">
          <div>David Peter</div>
          <div class="text-secondary">G1 / Class A</div>
        </div>
        <div class="circular-progress" data-progress="95">
          <svg width="60" height="60">
            <circle class="progress-bg" cx="30" cy="30" r="25"></circle>
            <circle class="progress-fill" cx="30" cy="30" r="25"></circle>
          </svg>
          <span class="progress-text">95%</span>
        </div>
      </div>
      <div class="student-row">
        <div class="student-avatar">LP</div>
        <div class="student-info">
          <div>Lily Paul</div>
          <div class="text-secondary">G1 / Class B</div>
        </div>
        <div class="circular-progress" data-progress="92">
          <svg width="60" height="60">
            <circle class="progress-bg" cx="30" cy="30" r="25"></circle>
            <circle class="progress-fill" cx="30" cy="30" r="25"></circle>
          </svg>
          <span class="progress-text">12%</span>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header">
    <h3>My Notes</h3>
    <button>Add Notes</button>
  </div>
  <div class="note-item">
    <div class="note-icon"><i class="fas fa-sticky-note"></i></div>
    <div class="note-content">
      <div class="note-title">Prepare Questions for Unit Test</div>
      <div class="text-secondary">Finalize the questions for Unit Test for Grade 9 Class A</div>
    </div>
    <div class="note-date">03 Nov 2023</div>
  </div>
  <div class="note-item">
    <div class="note-icon"><i class="fas fa-bullhorn"></i></div>
    <div class="note-content">
      <div class="note-title">Announcements to Students</div>
      <div class="text-secondary">Announce important updates to the students of Class B</div>
    </div>
    <div class="note-date">05 Nov 2023</div>
  </div>
  <a href="#" class="view-all">View All Notes</a>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Animate circular progress
    const circularProgressBars = document.querySelectorAll('.circular-progress');
    circularProgressBars.forEach(progressBar => {
      const circle = progressBar.querySelector('.progress-fill');
      const radius = circle.r.baseVal.value;
      const circumference = 2 * Math.PI * radius;
      const progress = progressBar.dataset.progress;

      circle.style.strokeDasharray = `${circumference} ${circumference}`;
      circle.style.strokeDashoffset = circumference;

      setTimeout(() => {
        const offset = circumference - (progress / 100) * circumference;
        circle.style.strokeDashoffset = offset;
      }, 100);
    });

    // Course card hover effect
    const courseCards = document.querySelectorAll('.course-card');
    courseCards.forEach(card => {
      card.addEventListener('mouseenter', () => {
        card.style.transform = 'translateY(-5px)';
        card.style.boxShadow = '0 6px 12px rgba(0, 0, 0, 0.15)';
      });
      card.addEventListener('mouseleave', () => {
        card.style.transform = 'translateY(0)';
        card.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.1)';
      });
    });
  });
</script>
{% endblock %}